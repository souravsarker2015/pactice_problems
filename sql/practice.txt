# select * from worker
# where first_name in ('vipul','satish')

# select * from worker
# where first_name not in ('vipul','satish')

# select * from worker
# where department in ('admin')

# select * from worker
# where first_name like "%a%"

select * from worker
where first_name like '%h' and length(first_name)=6


# select * from worker
# where salary between 100000 and 500000


# select * from worker
# where year(joining_date)=2014 and month(joining_date)=2

# select department,count(worker_id) as no_workers from worker
# group by department

# select first_name,salary from worker
# where salary>=50000 and salary<=100000

select department,count(worker_id) as no_worker from worker
group by department
order by no_worker desc


rst_name,w.salary,w.department,t.worker_title from worker as w
# inner join title as t
# on w.worker_id=t.worker_ref_id
# and t.worker_title='Manager'


# select w.first_name,w.salary,w.department,t.worker_title from worker as w
# inner join title as t
# on w.worker_id=t.worker_ref_id
# and t.worker_title='Manager'

# select worker_ref_id,worker_title,affected_from ,count(*) as t from title
# group by worker_title,affected_from
# having t>1

# select * from worker
# where worker_id%2!=0


# select * from title
# inner join worker
#
# select distinct worker_ref_id from title
# where worker_ref_id in (select worker_ref_id from bonus)


# select distinct worker_ref_id from title
# inner join bonus using (worker_ref_id)

# select distinct worker_ref_id from title
# where worker_ref_id not in (select worker_ref_id from bonus)

# select distinct worker_ref_id from title
# left join bonus using (worker_ref_id)
# where bonus.worker_ref_id = null

# select distinct (worker_ref_id) from title
# left join bonus using (worker_ref_id)
# where bonus.worker_ref_id is null


# select salary from worker
# order by salary desc limit 10

# select * from worker
# order by salary limit 5,1

# select *
# from worker as w1
# where (select count(distinct salary)
#        from worker w2
#        where w1.salary <= w2.salary) <= 4
# order by w1.salary desc;

# select * from worker as w1
# inner join worker as w2 on w1.salary =w2.salary
# and w1.worker_id !=w2.worker_id

# # select max(salary) from worker
# # where salary not in (select max(salary) from worker)
#
# # select * from worker as w1
# # where (select count(distinct salary) from worker as w2
# #     where w2.salary>=w1.salary) = 1
#
# # select * from worker
# # order by salary desc limit 1
#
# select max(salary)
# from worker
# where salary <
#       (select max(salary)
#        from worker
#        where salary not in
#              (select max(salary) from worker))
#
#

# select * from worker
# where worker_id<=(select count(worker_id)/2 from worker)

# select department,count(department) as t from worker
# group by department
# having t <=5

# select department,count(department) as t from worker
# group by department


# select * from worker
# where worker_id=(select max(worker_id) from worker)

# (select * from worker
# order by worker_id desc limit 5)
# order by worker_id

# select * from worker
# where worker_id>(select count(worker_id) from worker)-5

# select first_name,department,max(salary) from worker
# group by department

# select w1.first_name, w1.department, w1.salary
# from worker as w1
#          inner join
#      (select max(salary) as t, department
#       from worker
#       group by department) as new on w1.salary = new.t
#          and w1.department = new.department

# select salary from worker
# order by salary desc limit 3

select w1.* from worker as w1
where (select count(distinct salary) from worker as w2
    where w1.salary <=w2.salary) <=2 order by w1.salary desc

# # select max(salary) from worker
# # where salary not in (select max(salary) from worker)
#
# # select * from worker as w1
# # where (select count(distinct salary) from worker as w2
# #     where w2.salary>=w1.salary) = 1
#
# # select * from worker
# # order by salary desc limit 1
#
# select max(salary)
# from worker
# where salary <
#       (select max(salary)
#        from worker
#        where salary not in
#              (select max(salary) from worker))
#
#

# select * from worker
# where worker_id<=(select count(worker_id)/2 from worker)

# select department,count(department) as t from worker
# group by department
# having t <=5

# select department,count(department) as t from worker
# group by department


# select * from worker
# where worker_id=(select max(worker_id) from worker)

# (select * from worker
# order by worker_id desc limit 5)
# order by worker_id

# select * from worker
# where worker_id>(select count(worker_id) from worker)-5

# select first_name,department,max(salary) from worker
# group by department

# select w1.first_name, w1.department, w1.salary
# from worker as w1
#          inner join
#      (select max(salary) as t, department
#       from worker
#       group by department) as new on w1.salary = new.t
#          and w1.department = new.department

# select salary from worker
# order by salary desc limit 3

select w1.* from worker as w1
where (select count(distinct salary) from worker as w2
    where w1.salary <=w2.salary) <=2 order by w1.salary desc

# select distinct worker_ref_id from title
# inner join bonus using (worker_ref_id)

# select distinct worker_ref_id from title
# where worker_ref_id in (select worker_ref_id from bonus)


# select distinct worker_ref_id from title
# where worker_ref_id not in (select worker_ref_id from bonus)

# select distinct worker_ref_id from title
# left join bonus using(worker_ref_id)
# where bonus.worker_ref_id is null


# select * from worker
# order by salary asc limit 10

# select * from worker
# order by salary desc limit 4,1

# select * from worker as w1
# where (select count(distinct salary) from worker as w2
#     where w1.salary<=w2.salary)<=4


# select w1.first_name,w1.salary from worker as w1
# inner join worker as w2 on w1.worker_id!=w2.worker_id
# and w1.salary=w2.salary

# (select first_name, salary, department,t.worker_title
# from worker as w1
#          inner join title as t
#                     on w1.worker_id = t.worker_ref_id)

# select w1.first_name,w1.salary,w1.department,
# from worker as w1
# inner join worker as w2
#     on w1.worker_id!=w2.worker_id
# and w1.salary=w2.salary


