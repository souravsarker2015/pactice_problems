24
select department, count(department) as total
from worker
group by department
order by total desc

25
select w.first_name, w.department,t.worker_title
from worker as w
         inner join title as t
                    on w.worker_id = t.worker_ref_id
                        and t.worker_title = "manager"

35
select worker_id, salary
from worker as w1
where 4 = (select count(distinct salary)
           from worker as w2
            where w1.salary<=w2.salary)

36
44
select * from (select * from worker order by worker_id desc limit 5) as w1
order by w1.worker_id

45
select w.first_name, w.last_name, w.department, w.salary
from (select max(salary) as total, department
      from worker
      group by department) as new
         inner join worker as w
                    on w.department = new.department
                        and w.salary=new.total





select substring(first_name,1,3) from worker

# select position(binary 'a' in first_name ) from worker
# select instr(first_name,binary 'a') from worker
select position(binary 'a' in first_name) from worker
select ltrim(first_name) from worker

select replace(first_name,'a','A') from worker

# select concat(first_name," ",last_name) as complete_name from worker

# select * from worker
# order by first_name asc

# select * from worker
# where first_name in ('vipul','satish');

select * from worker
where first_name='vipul' or first_name= 'satish';

# select * from worker
# where department="admin";

# select * from worker
# where department in ('hr','admin');
#
# select * from worker
# where first_name like '%a';
# select * from worker
# where first_name like '%a%'

select * from worker
where first_name like '%a';


# select first_name from worker
# where first_name like '%h' and length(first_name)=6;

select first_name from worker
where first_name like '_____h'


# select * from worker
# where salary between 100000 and 500000
# order by salary desc ;

# select * from worker
# where year(joining_date)=2014 and month(joining_date)=2;


# select count(department) from worker
# where department='admin'

select count(worker_id) from worker
where department ='admin';

select worker_id,concat(first_name,' ',last_name) as Name,salary
from worker
where salary>=50000 and  salary <=100000
order by salary;

# select department,count(worker_id) as number_of_worker from worker
# group by department
# order by number_of_worker desc ;


important problems:
Q-24. Write an SQL query to print details of the Workers who are also Managers.

select w.first_name,w.department,w.salary,
       t.worker_title
from worker as w inner join
    title as t on
        w.worker_id = t.worker_ref_id and
        t.worker_title='manager';


select w.first_name,w.department,t.worker_title,b.bonus_amount
from worker as w
    inner join title t
    inner join bonus as b on
        w.worker_id = b.worker_ref_id=t.worker_ref_id
        and
           t.worker_title in ('manager') and
        b.bonus_amount=5000;

select worker_title,affected_from,count(*) as d from title
group by worker_title,affected_from
having d>1;


top salary:

select salary
from worker as w1
where (select count(distinct (salary)) from worker as w2 where
    w1.salary<=w2.salary)<=4
order by salary desc ;



Intersection:(INTERSECT is getting error in mysql)

# select distinct (worker_ref_id) from title
# inner join bonus using (worker_ref_id)


select distinct (worker_ref_id) from title
where worker_ref_id in(select worker_ref_id from bonus)

MINUS:
# select distinct (worker_ref_id) from title
# left join bonus using (worker_ref_id)
# where bonus.worker_ref_id is null


# select distinct (worker_ref_id) from title
# where worker_ref_id in(select worker_ref_id from bonus)





























































